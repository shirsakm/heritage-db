{% extends "base.html" %}

{% block title %}Heritage Results Database - Select Batch{% endblock %}

{% block extra_css %}
<style>
    .batch-selection-container {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 80vh;
    }

    .batch-card {
        background: linear-gradient(145deg, var(--nord4) 0%, var(--nord5) 100%);
        border-radius: var(--border-radius-lg);
        box-shadow: var(--shadow-md);
        transition: all 0.4s ease;
        border: 2px solid var(--nord7);
        position: relative;
        overflow: hidden;
        padding: var(--spacing-2xl);
    }

    .batch-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--nord7), var(--nord8), var(--nord9), var(--nord10));
        z-index: 1;
    }

    .batch-card:hover {
        box-shadow: var(--shadow-lg);
        border-color: var(--nord8);
    }

    .batch-link {
        text-decoration: none;
        display: block;
        width: 100%;
        color: inherit;
    }

    .batch-link:visited,
    .batch-link:hover,
    .batch-link:focus {
        color: inherit;
    }

    .batch-btn-content {
        display: flex;
        justify-content: center;
        align-items: center;
        position: relative;
        padding: var(--spacing-lg);
    }

    .batch-btn-content .fas {
        position: absolute;
        right: 0;
    }

    .batch-buttons-container {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-lg);
        max-width: 350px;
        margin: 0 auto;
    }

    .batch-buttons-container .btn-primary-nord {
        transition: transform 0.18s ease, box-shadow 0.18s ease;
    }

    .batch-buttons-container .btn-primary-nord:hover,
    .batch-buttons-container .btn-primary-nord:focus-visible {
        transform: translate(2px, 2px);
        box-shadow: 2px 2px 0 var(--nb-border-strong);
        background: var(--nb-primary);
    }

    .batch-buttons-container .btn-primary-nord:active {
        transform: translate(4px, 4px);
        box-shadow: none;
    }

    .page-title {
        text-align: center;
        margin-bottom: var(--spacing-2xl);
    }

    .page-title h1 {
        font-size: 2.5rem;
        margin-bottom: var(--spacing-lg);
    }

    /* Center the ::after component only on batch selection page */
    .page-title .title-text::after {
        left: 50%;
        transform: translateX(-50%);
    }

    /* Force disclaimer centered on batch selection page (overrides global desktop left alignment) */
    .page-title .disclaimer-text {
        text-align: center !important;
        display: block;
    }

    /* Phone-only tweaks: make cards/buttons span width and fit text */
    @media (max-width: 575.98px) {
        .batch-buttons-container {
            max-width: none;
            width: 100%;
            gap: var(--spacing-md);
        }

        /* Use inner padding and keep icon area clear */
        .batch-link .btn.btn-lg {
            padding: 0; /* let content control spacing */
        }
        .batch-btn-content {
            padding: var(--spacing-md) var(--spacing-lg);
            padding-right: 2.75rem; /* reserve space for right arrow */
        }

        /* Scale text to fit width on phones */
        .batch-btn-content span {
            display: block;
            width: 100%;
            white-space: nowrap; /* keep on one line */
            overflow: hidden;
            text-overflow: ellipsis; /* graceful fallback */
            font-size: clamp(0.82rem, 3.8vw, 1.2rem);
            line-height: 1.25;
        }

        /* Nudge icon in a bit and scale it slightly down */
        .batch-btn-content .fas {
            right: 0.5rem;
            font-size: 0.95em;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="batch-selection-container">
        <div class="batch-card fade-in-up">
            <div class="page-title">
                <h1 class="title-text">Heritage Results Database</h1>
                {% include 'components/disclaimer.html' %}
            </div>
            
            <div class="batch-buttons-container">
                {% for batch_year in ['2022', '2023', '2024'] %}
                <a href="{{ url_for('batch_table', batch=batch_year) }}" class="batch-link">
                    <button class="btn btn-primary-nord btn-lg w-100">
                        <div class="batch-btn-content">
                            <span class="text-center">Batch {{ batch_year }}-{{ batch_year|int + 4 }}</span>
                            <i class="fas fa-arrow-right"></i>
                        </div>
                    </button>
                </a>
                {% endfor %}
            </div>

            <!-- Footer inside white container -->
            <div class="mt-4 pt-3 text-center">
                {% include 'components/footer.html' %}
            </div>
        </div>
    </div>
</div>
<!-- Back to Top Button (shared with table pages) -->
<button id="backToTop" class="btn btn-back-to-top" aria-label="Back to top" style="display:flex;align-items:center;justify-content:center;">
    <i class="fas fa-arrow-up"></i>
</button>
{% endblock %}

{% block footer %}
<!-- Footer moved inside page content -->
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const backToTopBtn = document.getElementById('backToTop');
    if (!backToTopBtn) return;

    // Reuse styles if table.css not loaded (fallback minimal styles)
    if (!window.getComputedStyle(backToTopBtn).position || window.getComputedStyle(backToTopBtn).position === 'static') {
        backToTopBtn.style.position = 'fixed';
        backToTopBtn.style.bottom = '1.25rem';
        backToTopBtn.style.right = '1rem';
        backToTopBtn.style.width = '46px';
        backToTopBtn.style.height = '46px';
        backToTopBtn.style.borderRadius = '50%';
        backToTopBtn.style.background = 'linear-gradient(135deg, var(--nord8) 0%, var(--nord9) 100%)';
        backToTopBtn.style.color = 'var(--nord0)';
        backToTopBtn.style.border = '2px solid var(--nord7)';
        backToTopBtn.style.boxShadow = 'var(--shadow-md)';
        backToTopBtn.style.opacity = '0';
        backToTopBtn.style.visibility = 'hidden';
        backToTopBtn.style.transition = 'all .35s ease';
        backToTopBtn.style.zIndex = '1050';
    }

    const toggleBtn = () => {
        if (window.scrollY > 300) {
            backToTopBtn.classList.add('show');
            backToTopBtn.style.opacity = '0.95';
            backToTopBtn.style.visibility = 'visible';
            backToTopBtn.style.transform = 'translateY(0)';
        } else {
            backToTopBtn.classList.remove('show');
            backToTopBtn.style.opacity = '0';
            backToTopBtn.style.visibility = 'hidden';
            backToTopBtn.style.transform = 'translateY(20px)';
        }
    };
    window.addEventListener('scroll', toggleBtn, { passive: true });
    toggleBtn();

    backToTopBtn.addEventListener('click', (e) => {
        e.preventDefault();
        window.scrollTo({ top: 0, behavior: 'smooth' });
    });
});
</script>
{% endblock %}
